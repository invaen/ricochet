---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - ricochet/__init__.py
  - ricochet/__main__.py
  - ricochet/cli.py
  - ricochet/core/__init__.py
  - ricochet/utils/__init__.py
autonomous: true

must_haves:
  truths:
    - "User can run `python -m ricochet --help` and see available commands"
    - "User can run `python -m ricochet --version` and see version 0.1.0"
    - "Tool exits with code 0 on success, 2 on argument errors"
    - "Verbose flag (-v, -vv) is accepted"
  artifacts:
    - path: "ricochet/__init__.py"
      provides: "Package marker with __version__"
      contains: "__version__ = "
    - path: "ricochet/__main__.py"
      provides: "Entry point for python -m ricochet"
      min_lines: 3
    - path: "ricochet/cli.py"
      provides: "Argparse setup with subcommand structure"
      exports: ["main", "create_parser"]
  key_links:
    - from: "ricochet/__main__.py"
      to: "ricochet/cli.py"
      via: "imports main function"
      pattern: "from ricochet\\.cli import main"
    - from: "ricochet/cli.py"
      to: "ricochet/__init__.py"
      via: "imports __version__"
      pattern: "from ricochet import __version__"
---

<objective>
Create the CLI skeleton for Ricochet with argparse subcommand structure, version handling, and standard Unix conventions.

Purpose: Establish the foundation for all future CLI commands and ensure the tool follows standard CLI patterns.
Output: Working CLI that responds to --help, --version, and accepts -v verbosity flags.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create package structure</name>
  <files>
    ricochet/__init__.py
    ricochet/core/__init__.py
    ricochet/utils/__init__.py
  </files>
  <action>
    Create the package directory structure:

    1. Create `ricochet/__init__.py` with:
       - `__version__ = "0.1.0"`
       - Brief module docstring explaining what ricochet does

    2. Create `ricochet/core/__init__.py` as empty package marker

    3. Create `ricochet/utils/__init__.py` as empty package marker

    Directory structure after this task:
    ```
    ricochet/
    ├── __init__.py
    ├── core/
    │   └── __init__.py
    └── utils/
        └── __init__.py
    ```
  </action>
  <verify>
    ```bash
    python3 -c "from ricochet import __version__; print(__version__)"
    ```
    Should print: 0.1.0
  </verify>
  <done>Package imports successfully, version is accessible</done>
</task>

<task type="auto">
  <name>Task 2: Create CLI with argparse</name>
  <files>
    ricochet/cli.py
    ricochet/__main__.py
  </files>
  <action>
    Create the CLI entry point and argument parser:

    1. Create `ricochet/cli.py` with:
       - Import argparse, sys, pathlib
       - Import __version__ from ricochet
       - `create_parser()` function that returns ArgumentParser with:
         - prog='ricochet'
         - description='Second-order vulnerability detection tool'
         - --version flag using %(prog)s and __version__
         - -v/--verbose flag with action='count', default=0
         - --db flag (type=Path, default=None) for custom database path
         - subparsers with title='commands', dest='command', metavar='<command>'
         - (no subcommands yet - they'll be added in later phases)
       - `main()` function that:
         - Creates parser via create_parser()
         - Parses args
         - If no command given, prints help and returns 0
         - Handles KeyboardInterrupt returning 130
         - Handles exceptions returning 1
       - Follow patterns from 01-RESEARCH.md (Pattern 1 and Pattern 4)

    2. Create `ricochet/__main__.py` with:
       - Import main from ricochet.cli
       - Import sys
       - Call sys.exit(main())
       - Keep minimal - just the entry point
  </action>
  <verify>
    ```bash
    python3 -m ricochet --version
    python3 -m ricochet --help
    python3 -m ricochet -v --help
    python3 -m ricochet invalid-arg 2>/dev/null; echo "Exit code: $?"
    ```
    - --version prints "ricochet 0.1.0"
    - --help shows usage with commands section
    - -v flag is accepted
    - Invalid argument exits with code 2
  </verify>
  <done>CLI responds to --help with usage info, --version with 0.1.0, exits 2 on bad args</done>
</task>

</tasks>

<verification>
Run all verification commands:

```bash
# Package structure exists
ls -la ricochet/
ls -la ricochet/core/
ls -la ricochet/utils/

# Version accessible
python3 -c "from ricochet import __version__; print(__version__)"

# CLI works
python3 -m ricochet --version
python3 -m ricochet --help

# Exit codes correct
python3 -m ricochet; echo "Exit (no args): $?"
python3 -m ricochet --invalid-flag 2>/dev/null; echo "Exit (bad flag): $?"
```
</verification>

<success_criteria>
- `python -m ricochet --help` displays help with commands section
- `python -m ricochet --version` displays "ricochet 0.1.0"
- No external dependencies (stdlib only)
- Exit code 0 when run with no args (shows help)
- Exit code 2 on invalid arguments
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
